# 🚀 会员系统快速启动指南

## ⚡ 快速开始（5分钟）

### 1. 安装依赖
```bash
npm install
```

### 2. 初始化数据库
```bash
npm run init-db
```

这将创建所有必需的表，包括：
- ✅ users（用户）
- ✅ email_verifications（验证码）
- ✅ payment_plans（套餐）
- ✅ transactions（交易记录）
- ✅ usage_logs（使用记录）

并且创建：
- ✅ 3个默认套餐（按次5元、月50元、年300元）
- ✅ 管理员账户（admin@example.com / admin123456）

### 3. 启动服务器
```bash
npm start
```

### 4. 访问系统

打开浏览器访问：

- **注册页面**: http://localhost:3000/public/register.html
- **登录页面**: http://localhost:3000/public/login.html
- **管理后台**: http://localhost:3000/public/admin.html

## 👤 测试账户

### 管理员账户
- 邮箱：`admin@example.com`
- 密码：`admin123456`
- 权限：管理员（免费使用所有功能）

**首次登录后建议立即修改密码！**

## 📝 注册新用户流程

1. 访问注册页面
2. 输入邮箱
3. 点击"发送验证码"（验证码会发送到您配置的通知渠道）
4. 输入收到的6位验证码
5. 填写用户名和密码（至少8位）
6. 填写可选信息（手机、微信等）
7. 提交注册
8. 注册成功后跳转到登录页面

## 💰 充值流程（演示版）

1. 登录后点击右上角"会员中心"
2. 选择充值套餐：
   - 按次付费：¥5/次
   - 月度套餐：¥50（无限次）
   - 年度套餐：¥300（无限次）
3. 选择支付方式（演示版，任意选择）
4. 点击"立即充值"
5. **自动到账**（演示版跳过支付流程）

⚠️ **注意**: 当前为演示版，点击充值会立即到账，不需要真实支付

## 🎬 使用视频处理功能

### 必要条件
1. ✅ 已登录
2. ✅ 余额充足（每次处理 ¥5）

### 使用流程
1. 上传视频
2. 点击"开始处理"
3. 系统自动检查余额
4. 余额足够：开始处理并扣费
5. 余额不足：提示充值

### 费用说明
- 每处理1个视频扣费 ¥5
- 处理3个视频需要 ¥15
- 管理员账户免费使用

## 🔧 管理员功能

使用管理员账户登录后访问：http://localhost:3000/public/admin.html

可以查看：
- 📊 系统统计（用户数、总收入等）
- 👥 用户列表
- 💳 交易记录
- 📦 套餐管理
- 📥 导出用户Excel

## 🔐 安全提示

### ⚠️ 生产环境必须修改

1. **JWT密钥**
在 `.env` 中设置强密码：
```
JWT_SECRET=你的超级安全的随机字符串至少32位
```

2. **管理员密码**
首次登录后立即修改

3. **数据库密码**
使用强密码

## 💡 常见问题

### Q: 收不到验证码？
A: 检查 `.env` 中的邮件配置（RESEND_API_KEY）是否正确

### Q: 登录后立即跳回登录页？
A: 检查浏览器是否禁用了 localStorage 或 cookies

### Q: 充值后余额没变化？
A: 刷新页面或重新登录

### Q: 如何给用户手动充值？
A: 使用管理员权限直接修改数据库
```sql
UPDATE users SET balance = balance + 100 WHERE email = 'user@example.com';
```

### Q: 如何修改套餐价格？
A: 方式1（管理员API）:
```javascript
PUT /api/auth/admin/payment-plans/1
{
  "price": 10.00
}
```

方式2（数据库）:
```sql
UPDATE payment_plans SET price = 10.00 WHERE id = 1;
```

## 🎯 下一步

1. ✅ 测试注册流程
2. ✅ 测试登录流程
3. ✅ 测试充值流程
4. ✅ 测试视频处理（扣费）
5. ✅ 测试管理员后台
6. 📝 根据需要定制前端样式
7. 💳 接入真实支付API（生产环境）

## 📞 技术支持

遇到问题查看：
1. 服务器启动日志
2. 浏览器控制台
3. 数据库连接状态

所有功能已集成到当前系统，无需破坏现有功能！
